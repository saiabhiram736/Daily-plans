<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Page description">
    <meta name="keywords" content="html, css, javascript, bootstrap, jquery">
    <title>To-Do list</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" 
    integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    
</head>
<body>
    <header> 
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <img src="todo list logo.png" alt="logo" height="75">
            <a class="navbar-brand" href="#">
                <i><b>To-Do List</b></i>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar">
                <i class="bi bi-list"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbar">
                <div class="navbar-nav ms-auto">
                </div>
            </div>
        </div>
    </nav>  
    
    </header>  
        <div class="container p-5">
             <div class="alert alert-info text-center" role="alert">
                <h4 class="alert-heading">Welcome to the To-Do List Application!</h4>
                <p>This application allows you to manage your tasks efficiently. You can add, edit, and mark tasks as complete.</p>
                <hr>
                <p class="mb-0">Let's get started!</p>
            <h2 class="text-center mb-4">Interactive To-Do List</h2> 
             <div> 
                <button type="button" class="btn btn-outline-primary" onclick="showAddTaskModal()">
                Add Task 
                </button>
                <button type="button" class="btn btn-outline-danger" id="clearCompletedBtn" aria-label="Clear Completed Tasks">
        Clear Completed Tasks
    </button>

    
             </div>
            <div class="mb-5">
            </div>
                <div class="d-flex justify-content-center ">    
                    <div class="col-sm-12 col-md-12 col-lg-12"> 
                        <div class="card">
                           <div class="card-body">
                             <table class="table">
                             <thead class="text-center">
                                 <tr>
                        <th>S.NO</th>
                        <th>Task/Work's</th>
                        <th>Responsible</th>
                        <th>Greenwich Mean Time (GMT) </th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody  class="text-center" id="taskTableBody">
                    <!-- Task items will be dynamically added here -->

                </tbody>
            </table>
          </div>
        </div>  
      </div>
     </div>    
   </div>
   
 <div class="modal fade" id="addTaskModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="addTaskModalLabel" aria-hidden="true">
 <form id="taskInputform" onsubmit="event.preventDefault(); addTask();">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addTaskModalLabel">Add New Task</h5>
                <button type="button" class="btn-close"  data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label for="taskName" class="form-label">Task/Work's Name</label>
                    <textarea class="form-control" id="taskName" placeholder="Enter Task/Work's" name="task details" required></textarea>
                </div>
                <div class="mb-3">
                    <label for="responsiblePerson" class="form-label">Responsible Person</label>
                    <input type="text" class="form-control" id="responsiblePerson" placeholder="Enter Responsible Person's Name For The Task" name="Name of the Task Responsible Person" required>
                </div>
                <div class="mb-3">
                    <label for="taskDate" class="form-label">Day&Month&Year &Time (GMT)</label>
                    <input type="datetime-local" class="form-control" id="taskDate"   placeholder="Enter GMTime" name="task GMTime" required>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-primary">Add My Task</button>
            </div>
        </div>    

    </div>

 </form>

 </div>
</div>
    <footer class="text-center text-lg-start bg-light text-muted">
        <div class="text-center p-4">
            <b><i>Â© 2025 To-Do List Application. All rights reserved.</i></b>
        </div>
    </footer>    
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
    <script>
//
// Add simple 3D style and color format to table rows
(function apply3DStyle() {
    const style = document.createElement('style');
    style.innerHTML = `
    .table tbody tr {
        box-shadow: 0 2px 8px rgba(0,0,0,0.08), 0 1.5px 0 #e0e0e0;
        background: linear-gradient(90deg, #f8fafc 0%, #e3e9f7 100%);
        transition: transform 0.2s, box-shadow 0.2s;
    }
    .table tbody tr:hover {
        transform: translateY(-2px) scale(1.01);
        box-shadow: 0 6px 16px rgba(0,0,0,0.12), 0 2px 0 #b3c6e0;
        background: linear-gradient(90deg, #e3e9f7 0%, #f8fafc 100%);
    }
    .table thead {
        background: linear-gradient(90deg, #3a7bd5 0%, #00d2ff 100%);
        color: #fff;
        border-radius: 8px 8px 0 0;
    }
    .completed-task {
        text-decoration: line-through;
        color: #888 !important;
        background: #e6e6e6 !important;
    }
    `;
    document.head.appendChild(style);
})();

function getTasks() {
    const storage = localStorage.getItem('taskStorage');
    return storage ? JSON.parse(storage) : [];
}

function setTasks(tasks) {
    localStorage.setItem('taskStorage', JSON.stringify(tasks));
}

function removeTask(index) {
    if (!confirm('Are you sure you want to delete this task?')) return;
    const tasks = getTasks();
    tasks.splice(index, 1);
    setTasks(tasks);
    createHtmlStorage();
}

function showAddTaskModal() {
    $("#addTaskModalLabel").text("Add New Task");
    $(".modal-footer .btn-primary").text("Add My Task").off('click').on('click', function(event) {
        event.preventDefault();
        addTask();
    });
    $("#taskInputform")[0].reset();
    $("#addTaskModal").modal("show");
}

function addTask() {
    const dataArr = $("#taskInputform").serializeArray();
    let taskObject = {};
    for (let i in dataArr) {
        const name = dataArr[i]['name'];
        const value = dataArr[i]['value'];
        taskObject[name] = value;
    }
    taskObject['completed'] = false;
    const tasks = getTasks();
    tasks.push(taskObject);
    setTasks(tasks);
    $("#addTaskModal").modal("hide");
    $("#taskInputform")[0].reset();
    createHtmlStorage();
    showToast('Task added!');
}

function formatGMT(datetimeStr) {
    if (!datetimeStr) return '';
    const date = new Date(datetimeStr);
    if (isNaN(date.getTime())) return datetimeStr;
    const options = { month: 'long', day: 'numeric', year: 'numeric', hour: '2-digit', minute: '2-digit', hour12: false, timeZone: 'UTC' };
    return date.toLocaleString('en-US', options) + ' GMT';
}

function completeTask(index) {
    const tasks = getTasks(); 
    tasks[index]['completed'] = true;
    setTasks(tasks);
    createHtmlStorage();
    showToast('Task marked as completed!');
}

function editTask(index) {
    const tasks = getTasks();
    const task = tasks[index];
    $("#taskName").val(task['task details']);
    $("#responsiblePerson").val(task['Name of the Task Responsible Person']);
    $("#taskDate").val(task['task GMTime']);
    $("#addTaskModalLabel").text("Edit Task");
    const $primaryBtn = $(".modal-footer .btn-primary");
    $primaryBtn.text("Update Task");
    $primaryBtn.off('click').on('click', function(event) {
        event.preventDefault();
        updateTask(index);
    });
    $("#addTaskModal").modal("show");
}

function updateTask(index) {
    const dataArr = $("#taskInputform").serializeArray();
    const tasks = getTasks();
    let taskObject = tasks[index];
    for (let i in dataArr) {
        const name = dataArr[i]['name'];
        const value = dataArr[i]['value'];
        taskObject[name] = value;
    }
    tasks[index] = taskObject;
    setTasks(tasks);
    $("#addTaskModal").modal("hide");
    $("#taskInputform")[0].reset();
    createHtmlStorage();
    showToast('Task updated!');
}

function createHtmlStorage() {
    const tasks = getTasks();
    let html = '';
    if (tasks.length > 0) {
        tasks.forEach((task, i) => {
            html += `<tr class="${task.completed ? 'completed-task' : ''}">
                <td>${i + 1}</td>
                <td>${task['task details'] || ''}</td>
                <td>${task['Name of the Task Responsible Person'] || ''}</td>
                <td>${formatGMT(task['task GMTime'])}</td>
                <td>`;
            if (task.completed) {
                html += `<span class="badge bg-success" aria-label="Task Completed">Task Completed</span>`;
            } else {
                html += `
                <i class="bi bi-check-circle-fill text-success action-icon" data-action="complete" data-index="${i}" style="cursor:pointer;" title="Mark as completed" aria-label="Mark as completed"></i>
                <i class="bi bi-pencil-square text-primary action-icon" data-action="edit" data-index="${i}" style="cursor:pointer;" title="Edit Task" aria-label="Edit Task"></i>
                <i class="bi bi-trash-fill text-danger action-icon" data-action="delete" data-index="${i}" style="cursor:pointer;" title="Delete Task" aria-label="Delete Task"></i>
                `;
            }
            html += `</td></tr>`;
        });
    } else {
        html = '<tr><td colspan="5">No tasks available</td></tr>';
    }
    $("#taskTableBody").html(html);
}

// Event delegation for action icons
$(document).on('click', '.action-icon', function() {
    const action = $(this).data('action');
    const index = $(this).data('index');
    if (action === 'complete') completeTask(index);
    else if (action === 'edit') editTask(index);
    else if (action === 'delete') removeTask(index);
});

// Clear completed tasks
$('#clearCompletedBtn').on('click', function() {
    let tasks = getTasks();
    tasks = tasks.filter(task => !task.completed);
    setTasks(tasks);
    createHtmlStorage();
    showToast('Completed tasks cleared!');
});

// Simple toast notification
function showToast(message) {
    let toast = $('#customToast');
    if (toast.length === 0) {
        toast = $('<div id="customToast" style="position:fixed;bottom:30px;right:30px;z-index:9999;" class="alert alert-success" role="alert"></div>');
        $('body').append(toast);
    }
    toast.text(message).fadeIn(200);
    setTimeout(() => toast.fadeOut(400), 1500);
}

$(document).ready(function () {
    createHtmlStorage();
    $("#taskInputform").off('submit').on('submit', function(event) {
        event.preventDefault();
        addTask();
    });
    });

    </script>
</body>
</html>